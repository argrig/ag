#if 0
	shc Version 3.8.6, Generic Script Compiler
	Copyright (c) 1994-2006 Francisco Rosales <frosal@fi.upm.es>

	shc -f ../ker_im_chk.pl 
#endif

static  char data [] = 
#define      msg2_z	19
#define      msg2	((&data[4]))
	"\227\326\227\040\237\372\015\132\053\305\065\200\371\103\036\245"
	"\250\127\320\271\252\107\277\375"
#define      date_z	8
#define      date	((time_t*)(&data[32]))
	"\300\224\065\375\035\202\235\115\325\143\172\306\075\214\012\123"
	"\315"
#define      tst2_z	19
#define      tst2	((&data[44]))
	"\305\117\320\315\166\346\170\130\364\362\370\070\173\125\354\237"
	"\202\345\327\271\120\213\200\303"
#define      chk2_z	19
#define      chk2	((&data[68]))
	"\233\233\031\344\260\314\250\021\233\077\221\117\120\206\050\210"
	"\164\075\217\031\251\363\062\161\261"
#define      inlo_z	3
#define      inlo	((&data[90]))
	"\215\062\363"
#define      shll_z	14
#define      shll	((&data[96]))
	"\313\012\241\174\302\341\267\052\235\115\003\004\037\007\035\154"
	"\127\351\215"
#define      xecc_z	18
#define      xecc	((&data[113]))
	"\035\001\226\147\054\004\245\125\164\220\173\145\025\020\152\262"
	"\042\036\061\331"
#define      pswd_z	256
#define      pswd	((&data[189]))
	"\265\143\355\256\055\261\111\310\313\174\072\175\317\252\140\007"
	"\177\005\323\212\246\274\027\345\363\162\002\315\127\345\367\015"
	"\111\345\273\166\227\005\077\143\202\171\340\122\043\101\131\243"
	"\106\054\055\355\351\104\322\335\266\037\147\147\175\003\013\224"
	"\115\375\212\143\064\376\304\264\157\032\125\376\021\160\230\140"
	"\063\137\174\070\041\375\353\071\035\123\240\232\127\254\056\244"
	"\251\271\010\336\270\315\223\047\347\350\046\370\131\276\130\215"
	"\035\325\306\077\323\261\170\360\005\031\212\134\305\271\001\157"
	"\163\012\116\053\327\342\123\276\312\171\266\044\070\017\261\126"
	"\345\167\225\270\051\015\250\057\047\063\213\355\354\214\135\137"
	"\226\253\213\156\215\336\054\130\127\343\175\217\363\057\345\330"
	"\247\173\220\320\211\071\377\260\154\213\235\130\030\373\270\257"
	"\246\103\035\064\041\112\215\171\055\013\010\041\072\356\371\341"
	"\152\211\262\363\303\262\244\057\075\102\210\125\075\100\004\344"
	"\203\042\031\245\154\246\036\232\261\047\273\354\026\264\315\200"
	"\076\177\163\001\061\027\061\157\131\271\304\226\371\311\173\175"
	"\354\224\042\130\072\100\363\354\147\256\330\175\143\246\375\242"
	"\045\161\243\127\211\325\306\342\216\213\171\207\125\364\005\101"
	"\210\047\232\303\147\215\260\317\074\211\115\240\057\113\102\125"
	"\274\346\255\105\273\164\050\111\000\325\253\016\272\243\033\004"
	"\210\327\172"
#define      msg1_z	42
#define      msg1	((&data[464]))
	"\203\137\063\143\261\127\244\013\372\053\201\160\062\030\122\035"
	"\122\364\266\302\261\133\056\220\327\374\076\240\144\213\274\347"
	"\262\042\344\356\311\356\031\010\153\030\244\127\120\216\315\306"
	"\115\102\037\353\067\047\330\041\154\252"
#define      lsto_z	3
#define      lsto	((&data[513]))
	"\161\212\004"
#define      rlax_z	1
#define      rlax	((&data[516]))
	"\274"
#define      tst1_z	22
#define      tst1	((&data[518]))
	"\325\343\325\264\110\205\120\152\004\143\170\341\042\227\354\260"
	"\056\044\256\254\014\010\143\044"
#define      opts_z	1
#define      opts	((&data[541]))
	"\325"
#define      chk1_z	22
#define      chk1	((&data[544]))
	"\247\335\252\007\122\372\005\103\121\227\173\005\071\301\077\113"
	"\252\364\247\163\025\342\217\006\022\376"
#define      text_z	2458
#define      text	((&data[639]))
	"\155\125\040\105\166\214\360\164\257\160\036\340\253\153\055\352"
	"\101\122\244\067\123\030\261\264\277\216\306\276\020\344\267\176"
	"\072\327\303\260\143\264\045\022\045\104\363\320\257\040\273\361"
	"\162\140\050\306\171\332\172\070\150\101\367\171\046\256\367\140"
	"\205\273\021\351\157\066\373\314\305\272\212\250\346\202\330\023"
	"\043\143\354\266\325\325\247\321\266\137\323\270\233\255\170\333"
	"\341\305\123\300\070\235\307\160\260\061\112\204\355\230\236\015"
	"\050\253\323\061\301\256\352\223\076\271\351\363\370\062\252\205"
	"\315\102\314\030\201\216\204\357\344\137\122\120\261\313\041\312"
	"\132\075\202\261\342\264\047\302\370\066\070\143\132\371\155\323"
	"\300\120\331\122\342\161\066\173\300\207\160\176\250\257\200\177"
	"\314\371\113\152\115\047\260\215\152\153\352\025\103\113\071\255"
	"\035\164\216\166\177\024\060\104\273\075\213\112\042\140\363\043"
	"\177\261\225\212\230\243\106\227\111\141\027\376\044\377\340\164"
	"\032\174\252\056\321\347\216\165\232\266\225\257\235\303\136\066"
	"\227\175\105\004\301\057\147\072\330\264\336\277\027\160\055\020"
	"\131\316\135\213\046\323\077\376\103\116\371\363\162\375\264\270"
	"\222\265\307\243\064\346\013\051\207\113\233\263\060\376\305\121"
	"\276\362\063\176\335\255\054\250\024\266\065\050\320\177\025\334"
	"\034\345\072\343\320\001\224\043\146\275\112\220\366\262\214\371"
	"\016\000\303\374\030\125\050\157\021\346\232\212\304\175\146\201"
	"\372\200\075\275\226\327\344\271\271\136\057\260\062\152\351\356"
	"\000\066\105\152\014\366\170\140\370\161\137\204\250\247\171\313"
	"\221\247\333\071\372\000\270\360\065\150\233\375\144\271\023\367"
	"\220\321\312\142\237\323\142\052\255\022\267\366\162\130\024\277"
	"\277\157\111\024\170\201\021\143\332\052\047\316\375\161\360\363"
	"\352\070\275\156\006\112\041\072\047\203\071\272\215\370\301\232"
	"\246\037\162\372\301\172\322\175\233\067\232\311\200\231\145\055"
	"\216\175\247\334\130\113\350\374\164\217\044\304\265\213\371\074"
	"\335\000\220\150\166\025\343\034\343\142\160\211\254\040\143\370"
	"\047\070\370\062\152\167\055\156\225\333\344\321\062\170\226\071"
	"\377\323\106\071\011\360\320\154\167\331\273\256\174\032\377\030"
	"\052\326\132\331\200\066\034\343\242\045\340\165\216\222\166\123"
	"\236\017\152\204\211\032\065\365\266\073\020\043\122\131\331\342"
	"\131\346\244\162\332\217\272\170\152\025\240\156\325\017\041\323"
	"\032\000\013\267\342\360\332\253\016\337\277\200\022\210\317\122"
	"\302\027\275\307\301\207\200\243\076\357\372\076\060\314\156\311"
	"\156\336\266\346\010\062\160\060\055\340\201\305\211\004\012\225"
	"\353\150\042\065\216\156\342\170\131\200\235\176\027\276\233\303"
	"\102\077\127\123\223\230\310\076\126\261\042\371\173\355\377\026"
	"\174\060\101\312\252\152\171\262\310\340\034\257\240\146\035\274"
	"\155\310\142\214\347\117\302\010\306\057\356\273\051\113\260\334"
	"\316\172\104\264\345\115\031\171\350\351\107\240\175\336\203\311"
	"\351\106\256\143\124\235\130\034\137\340\050\046\203\350\003\214"
	"\330\303\106\026\076\342\111\024\245\354\135\147\237\352\203\035"
	"\235\050\235\017\270\057\330\024\257\351\255\113\165\364\256\220"
	"\057\072\203\042\056\323\011\162\074\206\263\164\301\272\236\156"
	"\111\107\060\246\061\241\013\216\107\203\240\161\305\354\103\042"
	"\073\264\005\012\310\242\232\020\201\212\334\200\246\337\365\142"
	"\034\070\303\102\124\134\105\144\220\250\275\256\361\015\303\020"
	"\031\104\034\013\063\274\207\203\107\173\264\135\147\176\005\334"
	"\306\136\104\330\132\146\256\317\042\201\221\175\317\227\026\041"
	"\310\212\225\312\101\361\377\334\163\373\053\357\123\215\073\142"
	"\200\074\347\254\034\326\015\373\204\034\057\026\152\140\377\215"
	"\045\036\326\023\121\321\157\204\101\016\032\236\071\014\315\135"
	"\332\304\307\066\044\103\332\303\063\262\246\044\057\347\222\377"
	"\022\051\306\370\364\275\154\046\351\264\065\300\305\307\061\313"
	"\353\367\216\042\132\374\115\144\165\135\203\075\265\313\061\310"
	"\154\023\250\255\327\360\122\252\106\175\066\171\333\276\000\257"
	"\022\127\021\072\106\111\323\023\101\022\071\055\110\266\301\145"
	"\344\072\172\031\237\045\136\061\231\000\305\302\017\111\032\121"
	"\126\022\023\264\352\036\233\276\150\107\005\050\206\252\164\104"
	"\335\257\274\332\352\137\202\067\306\005\033\244\215\375\222\347"
	"\365\001\117\124\231\264\156\116\335\224\162\252\042\151\173\375"
	"\152\151\263\332\003\047\227\256\353\270\373\022\073\102\022\073"
	"\247\066\305\325\071\167\337\202\145\115\003\261\107\032\212\155"
	"\307\361\374\344\006\211\057\235\150\332\347\256\374\064\146\347"
	"\056\115\374\122\023\020\100\130\114\343\204\156\251\032\330\153"
	"\274\044\132\267\027\044\253\046\035\217\023\267\142\135\011\042"
	"\145\155\237\001\073\040\126\147\330\107\116\023\035\304\233\222"
	"\137\073\357\003\335\064\151\072\370\132\163\155\274\010\203\102"
	"\075\017\336\020\172\023\103\265\253\050\204\001\037\270\055\356"
	"\174\220\143\254\143\253\257\227\267\017\154\003\130\025\331\272"
	"\013\163\071\121\250\100\203\305\061\145\227\036\063\373\042\311"
	"\266\235\016\352\045\171\144\014\225\173\317\172\232\052\171\004"
	"\254\375\137\027\274\364\162\135\063\166\067\371\125\334\317\017"
	"\127\350\326\174\362\215\321\133\200\173\124\062\137\036\173\013"
	"\055\326\204\274\027\073\001\160\343\110\032\220\142\124\342\242"
	"\236\062\336\022\357\330\371\100\306\012\072\170\123\076\335\176"
	"\154\266\134\022\104\223\073\271\015\124\024\021\036\277\270\254"
	"\015\277\360\221\200\050\004\100\117\001\150\313\127\136\274\137"
	"\256\113\056\146\277\070\312\017\344\311\275\266\263\235\355\235"
	"\271\120\347\223\266\216\330\263\255\135\221\367\061\254\271\127"
	"\321\340\300\122\067\253\024\111\367\372\373\025\370\033\147\121"
	"\174\250\121\201\103\107\352\327\306\350\073\030\335\352\325\347"
	"\152\364\260\322\013\242\303\110\160\227\170\020\104\322\242\313"
	"\235\215\312\157\061\167\123\270\237\303\203\335\175\157\025\271"
	"\056\212\317\137\335\135\053\235\244\331\204\015\370\340\223\377"
	"\221\343\103\267\020\140\027\342\071\243\233\302\320\141\377\232"
	"\045\117\303\210\126\267\211\013\362\261\001\324\143\035\176\217"
	"\174\371\036\077\301\127\216\032\006\177\125\047\344\137\206\042"
	"\025\026\224\077\337\314\032\105\052\374\100\225\027\253\200\054"
	"\115\127\120\166\117\370\051\261\171\173\371\144\245\063\075\027"
	"\167\004\072\257\116\210\361\350\005\035\023\372\231\167\326\235"
	"\352\141\226\233\232\345\377\126\321\142\061\371\333\243\164\246"
	"\307\025\017\351\271\000\212\113\203\353\203\356\132\146\304\135"
	"\262\261\241\305\324\036\320\224\314\364\107\312\214\174\057\331"
	"\205\016\044\000\130\015\143\244\043\222\333\330\070\336\153\010"
	"\257\106\315\177\200\012\375\125\150\371\253\117\122\323\024\061"
	"\011\016\010\332\277\303\134\126\135\020\127\015\220\051\156\340"
	"\012\305\152\333\315\301\250\160\325\320\134\306\203\017\242\115"
	"\275\242\344\117\150\370\027\204\031\272\051\263\235\001\266\103"
	"\236\202\130\327\341\116\256\313\213\023\027\261\233\072\012\206"
	"\061\243\335\044\042\042\223\133\366\005\151\232\054\256\025\071"
	"\161\074\231\335\272\053\270\306\027\257\361\032\036\167\111\210"
	"\323\040\333\025\320\235\064\013\237\316\172\251\062\133\147\134"
	"\122\253\207\065\026\117\006\272\113\143\067\045\347\335\276\331"
	"\236\354\204\250\246\142\356\243\211\247\110\124\025\360\357\366"
	"\322\204\127\255\245\017\015\332\005\250\372\204\102\342\173\340"
	"\077\233\216\071\304\204\237\127\155\206\046\040\227\220\101\177"
	"\236\026\331\110\124\261\370\265\374\102\165\363\175\217\226\273"
	"\257\362\115\167\100\327\127\352\223\327\324\220\264\214\235\317"
	"\261\002\300\204\125\373\212\021\133\227\274\171\377\112\107\125"
	"\326\234\056\252\025\344\125\004\234\005\201\021\243\147\152\007"
	"\245\342\161\341\040\230\227\331\304\031\254\166\363\345\244\202"
	"\212\231\230\370\071\170\347\202\233\071\151\306\346\216\122\045"
	"\201\066\241\171\025\353\040\322\122\272\136\322\237\304\252\221"
	"\356\134\337\164\304\256\161\240\147\163\004\377\270\205\041\243"
	"\014\263\274\054\356\115\130\255\365\062\054\271\330\003\200\171"
	"\061\234\353\257\073\260\300\066\341\306\275\141\200\131\146\324"
	"\002\305\052\152\312\136\323\366\306\163\144\362\062\011\056\214"
	"\272\272\324\100\320\353\265\124\131\302\334\151\124\265\116\126"
	"\114\220\123\267\072\104\225\364\360\335\067\234\332\224\220\261"
	"\141\266\227\144\332\360\232\156\205\111\135\003\003\240\332\211"
	"\363\215\277\354\213\071\146\310\055\017\067\016\334\076\045\011"
	"\142\040\037\353\040\226\150\077\273\320\113\211\133\020\110\001"
	"\226\053\231\001\275\133\146\213\344\304\107\223\233\144\035\120"
	"\035\202\273\004\060\041\303\115\041\311\146\201\064\176\076\221"
	"\126\070\014\122\306\263\373\064\223\302\315\021\024\227\303\101"
	"\334\307\224\253\143\232\121\130\214\000\040\374\362\337\361\112"
	"\021\346\231\355\161\260\040\362\014\110\213\065\160\360\173\313"
	"\007\067\123\204\046\232\051\244\143\236\060\355\061\005\275\240"
	"\335\355\214\132\276\343\061\367\166\215\125\104\017\113\140\172"
	"\267\277\143\107\125\230\037\051\235\240\275\303\154\313\070\134"
	"\231\307\164\260\114\141\202\164\050\221\100\320\237\342\113\202"
	"\272\245\114\043\172\056\214\375\270\111\035\102\125\103\363\301"
	"\113\261\346\336\305\256\173\151\127\305\116\143\235\152\372\076"
	"\123\103\263\201\367\167\200\324\331\227\254\154\137\016\017\154"
	"\243\253\037\312\352\016\015\147\002\232\077\013\253\346\147\315"
	"\046\354\221\315\337\203\140\343\063\310\240\271\200\214\346\051"
	"\213\173\024\101\236\170\372\143\074\053\262\246\103\371\244\373"
	"\214\050\216\123\001\132\370\117\116\066\321\277\132\227\171\322"
	"\247\237\072\110\061\031\002\032\330\360\354\273\155\165\045\241"
	"\067\151\136\046\373\016\317\073\046\011\335\102\376\232\077\036"
	"\140\315\353\312\035\176\236\114\055\150\114\021\236\161\372\236"
	"\217\155\060\136\222\310\272\177\366\105\315\034\367\122\201\373"
	"\164\003\155\127\206\114\207\023\330\324\307\033\255\234\344\327"
	"\375\012\265\251\372\100\043\247\142\106\263\021\171\031\340\176"
	"\152\177\045\376\303\272\333\205\256\364\205\227\167\023\252\376"
	"\117\367\160\343\062\152\110\323\232\272\254\036\353\111\335\020"
	"\243\012\247\066\322\031\235\213\163\145\124\054\266\214\143\136"
	"\376\011\037\032\053\117\121\031\314\341\277\347\373\274\346\144"
	"\073\331\344\066\164\174\312\015\330\260\374\065\201\006\047\063"
	"\227\056\102\162\213\246\060\275\146\136\350\002\352\230\272\001"
	"\101\175\025\231\315\256\203\116\011\133\003\326\101\361\157\275"
	"\157\265\160\150\110\313\211\021\013\007\126\030\245\241\016\120"
	"\247\043\346\175\156\017\353\105\056\264\217\042\061\254\324\251"
	"\304\201\122\145\147\235\231\135\326\273\152\032\256\323\065\007"
	"\121\225\172\356\145\052\017\041\033\202\202\104\110\373\036\303"
	"\064\207\005\053\000\054\331\367\215\137\263\236\110\042\325\104"
	"\267\117\062\035\172\102\077\226\304\301\332\015\274\370\321\361"
	"\177\326\034\200\003\366\170\220\125\053\056\236\116\004\342\006"
	"\124\025\044\316\127\143\144\034\045\076\051\342\067\372\323\267"
	"\321\357\067\325\345\260\145\073\333\224\331\051\230\274\057\354"
	"\321\124\273\050\267\037\104\334\136\156\276\226\151\222\116\072"
	"\201\205\017\147\065\165\243\021\012\174\072\243\071\152\217\012"
	"\276\113\063\166\152\170\123\311\346\022\140\120\244\256\212\045"
	"\064\232\215\152\020\060\173\032\255\266\275\346\040\115\361\337"
	"\230\044\126\003\235\251\315\204\273\055\324\140\333\137\206\017"
	"\372\023\171\013\103\365\045\361\253\343\330\314\061\311\253\312"
	"\356\002\315\213\253\233\020\147\310\344\307\244\104\116\264\076"
	"\141\056\111\245\043\157\226\316\123\157\232\205\070\106\117\047"
	"\110\035\263\364\270\303\134\201\250\044\046\354\162\332\053\324"
	"\010\165\171\053\345\020\372\070\177\224\275\270\333\015\337\044"
	"\052\222\031\343\126\166\145\376\232\213\353\015\145\026\341\155"
	"\213\133\231\160\154\223\251\354\050\147\244\004\165\204\050\237"
	"\027\102\203\155\270\350\153\122\164\126\140\331\155\101\107\371"
	"\235\341\152\011\164\023\365\235\173\231\241\360\036\312\220\065"
	"\014\024\242\304\374\016\027\160\144\167\112\322\271\221\313\126"
	"\163\065\137\347\111\125\205\304\356\046\265\015\360\106\102\375"
	"\132\344\302\127\362\331\310\127\121\022\051\013\244\364\141\027"
	"\051\301\377\163\026\204\067\005\253\355\022\234\063\124\231\215"
	"\071\133\344\053\065\254\203\206\277\254\222\143\241\363\173\313"
	"\265\172\076\313\377\166\321\252\143\343\106\227\070\340\044\161"
	"\073\011\235\161\265\040\370\165\315\212\330\156\175\124\072\062"
	"\317\170\376\316\356\317\171\122\263\277\351\353\237\016\135\333"
	"\027\373\115\315\033\105\102\351\317\033\130\115\157\222\200\077"
	"\013\177\015\371\116\206\114\002\106\066\356\346\104\113\302\133"
	"\106\017\050\142\124\153\114\044\206\244\161\366\066\362\065\102"
	"\161\103\074\300\312\210\302\020\276\260\366\002\374\270\136\103"
	"\310\206\245\034\362\361\101\171\226\262\157\314\245\245\017\027"
	"\351\113\327\263\323\232\303\222\113\272\224\110\163\362\213\073"
	"\171\060\130\154\042\231\345\270\114\125\205\361\372\224\010\344"
	"\337\340\227\263\172\132\105\306\024\331\016\210\314\231\303\106"
	"\312\033\262\354\265\227\245\001\354\052\363\347\276\373\313\236"
	"\334\143\121\127\275\226"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	0	/* Define as 1 to enable ptrace the executable */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

int chkenv(int argc)
{
	char buff[512];
	unsigned mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask  = (unsigned)chkenv;
	mask ^= (unsigned)getpid() * ~mask;
	sprintf(buff, "x%x", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%u %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%u %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;

	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && date[0]<time(NULL))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	ret = chkenv(argc);
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		if (text_z < hide_z) {
			/* Prepend spaces til a hide_z script size. */
			scrpt = malloc(hide_z);
			if (!scrpt)
				return 0;
			memset(scrpt, (int) ' ', hide_z);
			memcpy(&scrpt[hide_z - text_z], text, text_z);
		} else {
			scrpt = text;	/* Script text */
		}
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, argv[0]);
		} else {
			scrpt = argv[0];
		}
	}
	j = 0;
	varg[j++] = argv[0];		/* My own name at execution */
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
